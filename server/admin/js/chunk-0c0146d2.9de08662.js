(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c0146d2"],{"077b":function(t,e,a){"use strict";var i=a("2685"),r=a.n(i);r.a},"0ebb":function(t,e,a){"use strict";var i=a("1701"),r=a.n(i);r.a},"147e":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"source"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"key"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"el-icon-time"}),a("a",{staticStyle:{"margin-left":"10px"},attrs:{href:t.baseUrl+e.row.key,target:"block"}},[t._v("http://img.xujinfeng.top/"+t._s(e.row.key))])]}}])}),a("el-table-column",{attrs:{label:"mimeType"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("img",{attrs:{src:t.baseUrl+e.row.key,alt:"",width:"100",height:"100"}}),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[t._v("预览")])],1)])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("audio",{attrs:{autoplay:"",src:t.baseUrl+e.row.key}}),a("h2",[t._v(t._s(t.baseUrl+e.row.key))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1)],1)},r=[],s=a("3123"),o={data(){return{baseUrl:"http://img.xujinfeng.top/",tableData:[]}},created(){this.getSource()},methods:{async getSource(){const t=await Object(s["a"])();this.tableData=t.data.items}}},l=o,n=a("2877"),c=Object(n["a"])(l,i,r,!1,null,null,null);e["default"]=c.exports},1701:function(t,e,a){},2685:function(t,e,a){},3123:function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return s}));var i=a("8a43");function r(){return Object(i["a"])({url:"/qiniuUploadToken",method:"post"})}function s(){return Object(i["a"])({url:"/getQiniuSource",method:"get"})}},"691b":function(t,e,a){"use strict";var i=a("b737"),r=a.n(i);r.a},"8cdb":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"not-found"},[i("img",{attrs:{src:a("cb22"),alt:""}})])}],s={},o=s,l=(a("077b"),a("2877")),n=Object(l["a"])(o,i,r,!1,null,null,null);e["default"]=n.exports},"9d64":function(t,e,a){t.exports=a.p+"img/logo.82b9c7a5.png"},a55b:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("el-card",{staticClass:"login-card",attrs:{header:"账号登录"}},[a("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules}},[a("el-form-item",{attrs:{label:"账号",prop:"account"}},[a("el-input",{attrs:{placeholder:"请输入账号"},model:{value:t.ruleForm.account,callback:function(e){t.$set(t.ruleForm,"account",e)},expression:"ruleForm.account"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.ruleForm.password,callback:function(e){t.$set(t.ruleForm,"password","string"===typeof e?e.trim():e)},expression:"ruleForm.password"}})],1),a("el-form-item",{staticClass:"btn-row"},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submitForm}},[a("span",{staticStyle:{color:"white","font-weight":"600"}},[t._v("账号 ")]),a("span",{staticClass:"iconfont",staticStyle:{color:"white","font-size":"20px"}},[t._v("")])]),a("el-button",{attrs:{type:"info",loading:t.githubLoading},on:{click:t.toGithub}},[a("span",{staticStyle:{color:"black","font-weight":"600"}},[t._v("Github ")]),a("span",{staticClass:"iconfont",staticStyle:{color:"black","font-size":"20px"}},[t._v("")])]),a("el-button",{attrs:{type:"warning"},on:{click:t.tourisLogin}},[a("span",{staticStyle:{color:"#752","font-weight":"600"}},[t._v("游客 ")]),a("span",{staticClass:"iconfont",staticStyle:{color:"#863","font-size":"20px"}},[t._v("")])])],1)],1)],1)],1)},r=[],s=a("7ded"),o={name:"Login",data(){return{loading:!1,ruleForm:{account:"",password:""},rules:{account:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},code:"",githubLoading:!1}},created(){this.code=window.location.search.split("=").pop()||"",this.code&&(this.githubLoading=!0,this.githubLogin(this.code))},methods:{submitForm(){this.$refs.ruleForm.validate(t=>{t&&this.loginF()})},async loginF(){const{account:t,password:e}=this.ruleForm;this.$loading.show();const a=await Object(s["c"])({account:t,password:e});this.setSessionStorage(a)},async tourisLogin(){this.$loading.show();const t=await Object(s["d"])();this.setSessionStorage(t)},toGithub(){this.githubLoading=!0,this.$loading.show();const t="https://github.com/login/oauth/authorize?client_id=811be2d52886c5979fde&redirect_uri=http://47.107.105.76/admin";window.location.href=t},async githubLogin(t){const e=await Object(s["b"])({code:t});if(1==e.status)return this.$message.error(e.msg),void this.$loading.hide();sessionStorage.setItem("info",JSON.stringify(e.data)),this.setSessionStorage(e)},setSessionStorage(t){t&&(sessionStorage.setItem("token",t.token),sessionStorage.setItem("account",t.data.account)),this.$router.push("/"),this.$loading.hide()}}},l=o,n=(a("691b"),a("2877")),c=Object(n["a"])(l,i,r,!1,null,"36d8fb0d",null);e["default"]=c.exports},b737:function(t,e,a){},bb51:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"home"},[i("img",{attrs:{alt:"Vue logo",src:a("9d64")}})])}],s={name:"Home"},o=s,l=a("2877"),n=Object(l["a"])(o,i,r,!1,null,null,null);e["default"]=n.exports},c2fa:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h2",{staticClass:"title"},[t._v(t._s(t.id?"编辑":"新建")+"文章")]),a("el-form",{ref:"articleForm",attrs:{model:t.articleForm,rules:t.rules,"label-width":"100px"},nativeOn:{submit:function(e){return e.preventDefault(),t.saveArticle(e)}}},[a("el-form-item",{attrs:{label:"文章标题 :",prop:"title"}},[a("el-input",{model:{value:t.articleForm.title,callback:function(e){t.$set(t.articleForm,"title",e)},expression:"articleForm.title"}})],1),a("el-form-item",{attrs:{label:"文章类型 :",prop:"tags"}},[t.tagList?a("el-checkbox-group",{attrs:{size:"medium"},model:{value:t.articleForm.tags,callback:function(e){t.$set(t.articleForm,"tags",e)},expression:"articleForm.tags"}},t._l(t.tagList,(function(e){return a("el-checkbox-button",{key:e._id,attrs:{label:e._id}},[t._v(t._s(e.title))])})),1):t._e()],1),a("el-form-item",{attrs:{label:"设置置顶 :"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#666"},model:{value:t.articleForm.isTop,callback:function(e){t.$set(t.articleForm,"isTop",e)},expression:"articleForm.isTop"}}),a("span",{staticStyle:{"padding-left":"40px",color:"#606266"}},[t._v("设置可见 : ")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#666"},model:{value:t.articleForm.isShow,callback:function(e){t.$set(t.articleForm,"isShow",e)},expression:"articleForm.isShow"}})],1),a("el-form-item",{attrs:{label:"封 面 :"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl,"http-request":t.uploadImg,"show-file-list":!1,header:t.uploadHeaders}},[t.articleForm.thumbnail?a("img",{staticClass:"avatar",attrs:{src:t.articleForm.thumbnail}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"文章内容 :",prop:"contentMd"}},[a("markdown-editor",{staticClass:"me-write-editor",attrs:{editor:t.editor},on:{changeEdit:t.changeEdit}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[t._v("保存")])],1)],1)],1)},r=[],s=a("52d5"),o=a("2423"),l=a("f8bc"),n=a("3123"),c=a("8a43");async function u(t){const{data:e,status:a}=await Object(n["b"])();if(1===a)return;const i="http://upload-z2.qiniup.com";alert(t.file.type);let r=t.file.type.split("/").pop(),s={"image/png":"images","image/jpeg":"images","image/gif":"images","audio/mp3":"mp3","audio/mpeg":"mp3"};const o=`${s[t.file.type]}/${(new Date).getTime()}${Math.random().toString(36).slice(2)}.${r}`,l=new FormData;l.append("file",t.file),l.append("token",e),l.append("key",o);const u=await c["a"].post(i,l,{});return u}var d=u,m={components:{MarkdownEditor:s["a"]},mixins:[l["a"]],props:{id:{type:String}},data(){return{tagList:[],articleForm:{title:"",tags:[],thumbnail:"",isTop:!1,isShow:!1,contentMd:"",contentHtml:""},editor:{value:"",ref:"",default_open:"edit",toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,imagelink:!0,code:!0,fullscreen:!0,readmodel:!0,help:!0,undo:!0,redo:!0,trash:!1,ishljs:!0,navigation:!0,preview:!0}},rules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:3,max:25,message:"长度在 3 到 25 个字符",trigger:"blur"}],tags:[{required:!0,message:"请选择文章标签",trigger:"change"}],contentMd:[{required:!0,message:"请输入文章内容",trigger:"blur"}]}}},created(){this.getTag(),this.id&&this.getArticle()},methods:{async getTag(){const t=await Object(o["g"])({page:1,pageSize:999});this.tagList=t.data.tagList},async getArticle(){const t=await Object(o["e"])({id:this.id});this.articleForm=t.data,this.editor.value=t.data.contentMd},saveArticle(){let t,e;t=this.id,this.$refs.articleForm.validate(async a=>{a?(e=t?await Object(o["h"])({id:this.id,article:this.articleForm}):await Object(o["a"])({article:this.articleForm}),0===e.status&&this.$router.push("/article/ArticleList")):this.$message.error("填写错误，请检查!")})},changeEdit(t,e){this.articleForm.contentMd=e,this.articleForm.contentHtml=t},uploadImg(t){d(t).then(t=>{this.articleForm.thumbnail=t.url})}}},p=m,g=(a("0ebb"),a("2877")),h=Object(g["a"])(p,i,r,!1,null,"07cbe273",null);e["default"]=h.exports},cb22:function(t,e,a){t.exports=a.p+"img/404.6b8ae1d0.gif"}}]);
//# sourceMappingURL=chunk-0c0146d2.9de08662.js.map