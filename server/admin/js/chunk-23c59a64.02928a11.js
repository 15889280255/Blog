(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23c59a64"],{"13eb":function(t,e,a){},"3a77":function(t,e,a){"use strict";var r=a("13eb"),i=a.n(r);i.a},"447a":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"AdminList"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"默认不开启游客登录，添加 'Tourist' 类型管理员开启游客登录",placement:"top"}},[a("el-button",{attrs:{type:"primary addDialog",plain:""},on:{click:function(e){t.openDialog=!0}}},[a("div",[a("i",{staticClass:"el-icon-circle-plus"}),a("span",[t._v(" 添加管理员")])])])],1),a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"管理员列表"}},[t.tableData?a("el-table",{staticClass:"table",attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"_id",label:"编号",width:"350"}}),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"250"}}),a("el-table-column",{attrs:{prop:"role.type",label:"类型"}}),a("el-table-column",{staticClass:"option",attrs:{label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-popconfirm",{attrs:{title:"确定删除该管理员吗?"},on:{onConfirm:function(a){return t.handleDelete(e.row._id)}}},[a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[a("div",[t._v("删除")])])],1)],1)]}}],null,!1,770790673)})],1):t._e()],1),a("el-dialog",{attrs:{title:"信息添加",visible:t.openDialog},on:{"update:visible":function(e){t.openDialog=e}}},[a("el-form",{ref:"formData",attrs:{model:t.formData,rules:t.rules}},[a("el-form-item",{attrs:{label:"角色","label-width":t.formLabelWidth,prop:"role"}},[a("el-select",{attrs:{autocomplete:"off"},model:{value:t.formData.role,callback:function(e){t.$set(t.formData,"role",e)},expression:"formData.role"}},t._l(t.roleList,(function(t){return a("el-option",{key:t._id,attrs:{label:t.type,value:t._id}})})),1)],1),a("el-form-item",{attrs:{label:"名字","label-width":t.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"账号","label-width":t.formLabelWidth,prop:"account"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.formData.account,callback:function(e){t.$set(t.formData,"account",e)},expression:"formData.account"}})],1),a("el-form-item",{attrs:{label:"密码","label-width":t.formLabelWidth,prop:"password"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.formData.password,callback:function(e){t.$set(t.formData,"password",e)},expression:"formData.password"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.openDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[a("div",[t._v("确 定")])])],1)],1)],1)],1)},i=[],n=(a("96cf"),a("1da1")),o=a("8a43");function s(t){return Object(o["a"])({url:"/admin/edit",method:"post",data:t})}function l(t){return Object(o["a"])({url:"/admin/delete",method:"delete",params:t})}function c(t){return Object(o["a"])({url:"/admin/update",method:"put",data:t})}function u(t){return Object(o["a"])({url:"/admin/list",method:"get",params:t})}function m(t){return Object(o["a"])({url:"/role/list",method:"get",params:t})}var d={data:function(){return{tableData:[],openDialog:!1,formData:{id:"",role:"",name:"",account:"",password:""},formLabelWidth:"120px",roleList:[],rules:{role:{required:!0,message:"请选择角色",trigger:"change"},name:[{required:!0,message:"请输入名字",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 15 个字符",trigger:"blur"}],account:{required:!0,message:"请输入账号",trigger:"blur"},password:{required:!0,message:"请输入密码",trigger:"blur"}}}},created:function(){this.initAdminList(),this.initRoleList()},methods:{initAdminList:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:a=e.sent,t.tableData=a.data;case 4:case"end":return e.stop()}}),e)})))()},initRoleList:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:a=e.sent,t.roleList=a.data;case 4:case"end":return e.stop()}}),e)})))()},createAdmin:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.formData,!a.id){e.next=7;break}return e.next=4,c(a);case 4:r=e.sent,e.next=10;break;case 7:return e.next=9,s(t.formData);case 9:r=e.sent;case 10:t.formData={},0==r.status&&t.initAdminList(),t.openDialog=!1;case 13:case"end":return e.stop()}}),e)})))()},submitForm:function(){var t=this;this.$refs.formData.validate((function(e){e&&t.createAdmin()}))},handleDelete:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,l({id:t});case 2:r=a.sent,0==r.status&&e.initAdminList();case 4:case"end":return a.stop()}}),a)})))()}}},f=d,p=(a("fdea"),a("2877")),b=Object(p["a"])(f,r,i,!1,null,null,null);e["default"]=b.exports},"4f2f":function(t,e,a){},c2fa:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h2",{staticClass:"title"},[t._v(t._s(t.id?"编辑":"新建")+"文章")]),a("el-form",{ref:"articleForm",attrs:{model:t.articleForm,rules:t.rules,"label-width":"100px"},nativeOn:{submit:function(e){return e.preventDefault(),t.saveArticle(e)}}},[a("el-form-item",{attrs:{label:"文章标题 :",prop:"title"}},[a("el-input",{model:{value:t.articleForm.title,callback:function(e){t.$set(t.articleForm,"title",e)},expression:"articleForm.title"}})],1),a("el-form-item",{attrs:{label:"文章类型 :",prop:"tags"}},[t.tagList?a("el-checkbox-group",{attrs:{size:"medium"},model:{value:t.articleForm.tags,callback:function(e){t.$set(t.articleForm,"tags",e)},expression:"articleForm.tags"}},t._l(t.tagList,(function(e){return a("el-checkbox-button",{key:e._id,attrs:{label:e._id}},[t._v(t._s(e.title))])})),1):t._e()],1),a("el-form-item",{attrs:{label:"设置置顶 :"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#666"},model:{value:t.articleForm.isTop,callback:function(e){t.$set(t.articleForm,"isTop",e)},expression:"articleForm.isTop"}}),a("span",{staticStyle:{"padding-left":"40px",color:"#606266"}},[t._v("设置可见 : ")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#666"},model:{value:t.articleForm.isShow,callback:function(e){t.$set(t.articleForm,"isShow",e)},expression:"articleForm.isShow"}})],1),a("el-form-item",{attrs:{label:"封 面 :"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl,headers:t.uploadHeaders,"show-file-list":!1,"on-success":t.handleThumbnailSuccess}},[t.articleForm.thumbnail?a("img",{staticClass:"avatar",attrs:{src:t.articleForm.thumbnail}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"文章内容 :",prop:"contentMd"}},[a("markdown-editor",{staticClass:"me-write-editor",attrs:{editor:t.editor},on:{changeEdit:t.changeEdit}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[t._v("保存")])],1)],1)],1)},i=[],n=(a("96cf"),a("1da1")),o=a("52d5"),s=a("2423"),l=a("f8bc"),c={components:{MarkdownEditor:o["a"]},mixins:[l["a"]],props:{id:{type:String}},data:function(){return{tagList:[],articleForm:{title:"",tags:[],thumbnail:"",isTop:!1,isShow:!1,contentMd:"",contentHtml:""},editor:{value:"",ref:"",default_open:"edit",toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,imagelink:!0,code:!0,fullscreen:!0,readmodel:!0,help:!0,undo:!0,redo:!0,trash:!1,ishljs:!0,navigation:!0,preview:!0}},rules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:3,max:25,message:"长度在 3 到 25 个字符",trigger:"blur"}],tags:[{required:!0,message:"请选择文章标签",trigger:"change"}],contentMd:[{required:!0,message:"请输入文章内容",trigger:"blur"}]}}},created:function(){this.getTag(),this.id&&this.getArticle()},methods:{getTag:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["g"])({page:1,pageSize:999});case 2:a=e.sent,t.tagList=a.data.tagList;case 4:case"end":return e.stop()}}),e)})))()},getArticle:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["e"])({id:t.id});case 2:a=e.sent,t.articleForm=a.data,t.editor.value=a.data.contentMd;case 5:case"end":return e.stop()}}),e)})))()},saveArticle:function(){var t,e,a=this;t=this.id,this.$refs.articleForm.validate(function(){var r=Object(n["a"])(regeneratorRuntime.mark((function r(i){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(i){r.next=5;break}return a.$message.error("填写错误，请检查!"),r.abrupt("return");case 5:if(!t){r.next=11;break}return r.next=8,Object(s["h"])({id:a.id,article:a.articleForm});case 8:e=r.sent,r.next=14;break;case 11:return r.next=13,Object(s["a"])({article:a.articleForm});case 13:e=r.sent;case 14:0===e.status&&a.$router.push("/article/ArticleList");case 15:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())},handleThumbnailSuccess:function(t){0==t.status?(this.$message.success("".concat(t.msg)),this.articleForm.thumbnail=t.data.url):this.$message.error("".concat(t.msg))},changeEdit:function(t,e){this.articleForm.contentMd=e,this.articleForm.contentHtml=t}}},u=c,m=(a("3a77"),a("2877")),d=Object(m["a"])(u,r,i,!1,null,"58f01213",null);e["default"]=d.exports},fdea:function(t,e,a){"use strict";var r=a("4f2f"),i=a.n(r);i.a}}]);
//# sourceMappingURL=chunk-23c59a64.02928a11.js.map